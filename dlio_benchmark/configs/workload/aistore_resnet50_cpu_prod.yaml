model:
  name: aistore_resnet50_cpu_production
  type: cnn

framework: pytorch

workflow:
  generate_data: True
  train: True
  checkpoint: False      # Disable for pure I/O benchmark
  evaluation: True

dataset:
  data_folder: s3://mlcommons-resnet50-cpu
  format: npy            # NPY faster than JPEG on CPU
  num_files_train: 10000  # 1M samples total
  num_files_eval: 1000
  num_samples_per_file: 100
  record_length_bytes: 150528  # 224x224x3 float32
  record_length_bytes_stdev: 0
  num_subfolders_train: 100
  num_subfolders_eval: 10

storage:
  storage_type: aistore
  storage_root: mlcommons-resnet50-cpu
  storage_options:
    endpoint_url: http://aistore-proxy:8080

reader:
  data_loader: pytorch
  batch_size: 64         # Optimized for CPU
  batch_size_eval: 64
  read_threads: 8        # Adjust based on CPU cores
  file_shuffle: seed
  sample_shuffle: seed
  prefetch_size: 4
  computation_threads: 0 # Use all available CPU cores

train:
  epochs: 10
  computation_time: 0.05 # Simulated CPU forward+backward

evaluation:
  eval_time: 0.025
  epochs_between_evals: 1

checkpoint:
  checkpoint_folder: /tmp/checkpoints/resnet50_cpu
  checkpoint_after_epoch: 100
  epochs_between_checkpoints: 100


