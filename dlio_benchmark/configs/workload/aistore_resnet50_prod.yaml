model:
  name: aistore_resnet50_production
  type: cnn

framework: pytorch

workflow:
  generate_data: True
  train: True
  checkpoint: True
  evaluation: True

dataset:
  data_folder: s3://mlcommons-resnet50
  format: npy
  num_files_train: 128116    # ImageNet: 1.28M images / 10 per file
  num_files_eval: 5000
  num_samples_per_file: 10
  record_length_bytes: 150528  # 224x224x3 float32 for ResNet50
  record_length_bytes_stdev: 0
  num_subfolders_train: 1024
  num_subfolders_eval: 50

storage:
  storage_type: aistore
  storage_root: mlcommons-resnet50
  storage_options:
    endpoint_url: http://aistore-proxy:8080

reader:
  data_loader: pytorch
  batch_size: 256
  batch_size_eval: 256
  read_threads: 16
  file_shuffle: seed
  sample_shuffle: seed
  prefetch_size: 8
  transfer_size: 262144    # 256KB transfers

train:
  epochs: 90
  computation_time: 0.1    # Simulate ResNet50 forward+backward

evaluation:
  eval_time: 0.05
  epochs_between_evals: 1

checkpoint:
  checkpoint_folder: /mnt/shared/checkpoints/resnet50
  checkpoint_after_epoch: 10
  epochs_between_checkpoints: 10
  steps_between_checkpoints: 1000



